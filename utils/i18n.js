// utils/i18n.js - Traduções simples por idioma (fallback: en)
const dictionaries = {
    en: {
        selection_manual: '**Team selection:** Manual (choose your team)',
        selection_auto: '**Team selection:** Random',
        panel_title: 'Simulator {mode} – {game}',
        panel_players: '**Players ({count}/{max})**',
        panel_team_line: '**Team {num}** ({count}/{max}): {players}',
        panel_no_players: 'No players yet',
        panel_waiting: 'Waiting for players...',
        panel_full: 'Simulator full!',
        join_success: 'You joined the simulator!',
        join_team: 'You joined Team {team}!',
        switch_team: 'You switched to Team {team}!',
        join_already: 'You are already in this simulator.',
        join_full: 'This simulator is full.',
        leave_success: 'You left the simulator.',
        leave_not_in: 'You are not in this simulator.',
        simul_closed: 'This simulator is no longer open.',
        team_same: 'You are already on this team!',
        team_full: 'This team is full!',
        banned_global_title: 'Banned by Sky team',
        banned_global_desc: 'You are banned from playing simulators by the Sky team.\n\nAppeal: https://discord.com/invite/8M83fTdyRW',
        banned_local: 'You are banned from simulators in this server.',
        no_prize: 'No prize',
        invalid_quantity_1v1: 'Invalid quantity for 1v1!\n\nAccepted quantities: {quantities}',
        invalid_quantity_2v2: 'Invalid quantity for 2v2!\n\nAccepted quantities: {quantities}',
        invalid_quantity_3v3: 'Invalid quantity for 3v3!\n\nAccepted quantities: {quantities}',
        invalid_quantity_4v4: 'Invalid quantity for 4v4!\n\nAccepted quantities: {quantities}',
        no_simu_role_configured: 'This server has not configured the simulator creator role yet.\n\nAn admin must use `/setup` first.',
        no_permission_create_simu: 'You do not have permission to create simulators.',
        error_create_simulator: 'Error creating simulator. Please try again.',
        already_banned_local: 'This user is already banned from simulators in this server.',
        ban_local_success: '{user} has been banned from participating in simulators in this server.',
        error_ban_process: 'Error processing ban.',
        not_banned_local: 'This user is not banned from simulators in this server.',
        unban_local_success: '{user} has been unbanned from participating in simulators in this server.',
        error_unban_process: 'Error processing unban.',
        owner_only: 'Only the bot owner can use this command.',
        default_ban_reason: 'Banned by Sky team',
        already_banned_global: '{user} is already globally banned.',
        ban_global_success: '{user} has been globally banned from all simulators.\n\nReason: {motivo}',
        not_banned_global: '{user} is not globally banned.',
        unban_global_success: '{user} has been globally unbanned and can play simulators again.',
        different_players_required: 'The players must be different!',
        no_simulator_in_channel: 'No simulator found in this channel.',
        only_creator_remove: 'Only the simulator creator can remove players.',
        player_not_in_simulator: '{player} is not participating in this simulator.',
        substitute_already_in_simulator: '{player} is already participating in this simulator.',
        player_removed_title: 'Player Removed',
        player_removed: 'Removed: {player}',
        player_removed_and_substituted: 'Removed: {removed}\nSubstituted by: {substitute}',
        simulator_footer: 'Simulator: {game} {mode}',
        error_remove_player: 'Error removing player. Please try again.',
        no_running_tournament: 'No running tournament found in this server.',
        only_creator_alter: 'Only the tournament creator can alter players.',
        player_not_in_tournament: '{player} is not participating in this tournament.',
        substitute_already_in_tournament: '{player} is already participating in this tournament.',
        no_bracket_generated: 'This tournament does not have a bracket generated yet.',
        player_not_in_pending_matches: '{player} was not found in any pending matches.\n\nPossible reasons:\n• The player was already eliminated\n• All of the player\'s matches have been completed',
        player_substitution_title: 'Player Substitution',
        player_substitution_desc: '{removed} has been substituted by {added}',
        player_substituted_title: 'Player Substituted',
        player_substituted_desc: 'Removed: {removed}\nAdded: {added}\n\nMatch: {match}\nPosition: {team}',
        tournament_footer: 'Tournament: {game} {mode}',
        error_substitute_player: 'Error substituting player. Please try again.',
        old_panel_warning: '⚠️ This panel is from an old version and is no longer compatible.',
        old_panel_solution: 'Please recreate the simulator to use the updated version with multilanguage support.',
        help_title: 'Bot Commands',
        help_description: 'Here are the main commands available in this server.',
        help_commands: {
            setup: 'Configure channel/role/language for the bot.',
            simulador1v1: 'Create 1v1 simulator.',
            simulador2v2: 'Create 2v2 simulator.',
            simulador3v3: 'Create 3v3 simulator.',
            simulador4v4: 'Create 4v4 simulator.',
            banir_simu: 'Ban a user from simulators in this server.',
            desbanir_simu: 'Unban a user from simulators in this server.',
            banir_jogador: 'Globally ban a user from all simulators.',
            desbanir_jogador: 'Globally unban a user.',
            banir_server: 'Ban a server from using the bot.',
            desbanir_server: 'Unban a server.',
            adicionar_permissao: 'Grant owner-level permission to a user.',
            remover_jogador: 'Remove or substitute a player from simulator.',
            alterar_jogador: 'Substitute a player in running tournament.',
            help: 'Show this help message.'
        },
        help_footer: 'Language: English',
        setup_success: 'Configuration saved!',
        setup_role: 'Role',
        setup_language: 'Language',
        setup_permission_info: 'Only members with the role {role} can create simulators.'
    },
    zh: {
        selection_manual: '**队伍选择：** 手动（自行选择队伍）',
        selection_auto: '**队伍选择：** 随机',
        panel_title: '模拟器 {mode} – {game}',
        panel_players: '**玩家 ({count}/{max})**',
        panel_team_line: '**队伍 {num}** ({count}/{max}): {players}',
        panel_no_players: '尚无玩家',
        panel_waiting: '等待玩家加入...',
        panel_full: '模拟器已满！',
        join_success: '你已加入模拟器！',
        join_team: '你加入了 {team} 队！',
        switch_team: '你切换到了 {team} 队！',
        join_already: '你已在此模拟器中。',
        join_full: '此模拟器已满。',
        leave_success: '你已离开模拟器。',
        leave_not_in: '你不在此模拟器中。',
        simul_closed: '此模拟器已关闭。',
        team_same: '你已经在这个队伍里！',
        team_full: '这个队伍已满！',
        banned_global_title: '被 Sky 团队封禁',
        banned_global_desc: '你被 Sky 团队禁止参加模拟器。\n\n申诉: https://discord.com/invite/8M83fTdyRW',
        banned_local: '你在此服务器的模拟器中被封禁。',
        error_generic: '发生错误，请稍后再试。',
        old_panel_warning: '⚠️ 此面板来自旧版本，不再兼容。',
        old_panel_solution: '请重新创建模拟器以使用支持多语言的新版本。',
        help_title: '机器人指令',
        help_description: '以下是此服务器可用的主要指令。',
        help_commands: {
            setup: '配置频道/角色/语言。',
            simulador1v1: '创建 1v1 模拟器。',
            simulador2v2: '创建 2v2 模拟器。',
            simulador3v3: '创建 3v3 模拟器。',
            simulador4v4: '创建 4v4 模拟器。',
            banir_simu: '封禁本服的用户。',
            desbanir_simu: '解除本服用户封禁。',
            banir_jogador: '全局封禁用户。',
            desbanir_jogador: '解除全局封禁。',
            banir_server: '封禁一个服务器。',
            desbanir_server: '解除服务器封禁。',
            adicionar_permissao: '给予用户所有者级权限。',
            remover_jogador: '从模拟器移除或替换玩家。',
            alterar_jogador: '在运行中的比赛中替换玩家。',
            help: '显示此帮助。'
        },
        help_footer: '语言: 中文',
        setup_success: '配置已保存！',
        setup_role: '角色',
        setup_language: '语言',
        setup_permission_info: '只有拥有 {role} 角色的成员才能创建模拟器。'
    },
    es: {
        selection_manual: '**Selección de equipos:** Manual (elige tu equipo)',
        selection_auto: '**Selección de equipos:** Aleatoria',
        panel_title: 'Simulador {mode} – {game}',
        panel_players: '**Jugadores ({count}/{max})**',
        panel_team_line: '**Equipo {num}** ({count}/{max}): {players}',
        panel_no_players: 'Aún no hay jugadores',
        panel_waiting: 'Esperando jugadores...',
        panel_full: '¡Simulador lleno!',
        join_success: '¡Te uniste al simulador!',
        join_team: '¡Te uniste al Equipo {team}!',
        switch_team: 'Cambiaste al Equipo {team}!',
        join_already: 'Ya estás en este simulador.',
        join_full: 'Este simulador está lleno.',
        leave_success: 'Saliste del simulador.',
        leave_not_in: 'No estás en este simulador.',
        simul_closed: 'Este simulador ya no está abierto.',
        team_same: '¡Ya estás en este equipo!',
        team_full: '¡Este equipo está lleno!',
        banned_global_title: 'Vetado por el equipo Sky',
        banned_global_desc: 'Estás vetado de jugar simuladores por el equipo Sky.\n\nApela en: https://discord.com/invite/8M83fTdyRW',
        banned_local: 'Estás vetado de simuladores en este servidor.',
        error_generic: 'Ocurrió un error. Inténtalo de nuevo.',
        old_panel_warning: '⚠️ Este panel es de una versión antigua y ya no es compatible.',
        old_panel_solution: 'Por favor recrea el simulador para usar la versión actualizada con soporte multiidioma.',
        help_title: 'Comandos del bot',
        help_description: 'Estos son los comandos principales disponibles en este servidor.',
        help_commands: {
            setup: 'Configurar canal/rol/idioma del bot.',
            simulador1v1: 'Crear simulador 1v1.',
            simulador2v2: 'Crear simulador 2v2.',
            simulador3v3: 'Crear simulador 3v3.',
            simulador4v4: 'Crear simulador 4v4.',
            banir_simu: 'Vetará a un usuario en este servidor.',
            desbanir_simu: 'Desvetará a un usuario en este servidor.',
            banir_jogador: 'Vetará globalmente a un usuario.',
            desbanir_jogador: 'Desvetará globalmente a un usuario.',
            banir_server: 'Vetará un servidor.',
            desbanir_server: 'Desvetará un servidor.',
            adicionar_permissao: 'Da permiso de dueño a un usuario.',
            remover_jogador: 'Remover o sustituir un jugador del simulador.',
            alterar_jogador: 'Sustituir un jugador en torneo en curso.',
            help: 'Muestra esta ayuda.'
        },
        help_footer: 'Idioma: Español',
        setup_success: '¡Configuración guardada!',
        setup_role: 'Rol',
        setup_language: 'Idioma',
        setup_permission_info: 'Solo los miembros con el rol {role} pueden crear simuladores.'
    },
    fr: {
        selection_manual: '**Choix d’équipe :** Manuel (choisissez votre équipe)',
        selection_auto: '**Choix d’équipe :** Aléatoire',
        panel_title: 'Simulateur {mode} – {game}',
        panel_players: '**Joueurs ({count}/{max})**',
        panel_team_line: '**Équipe {num}** ({count}/{max}) : {players}',
        panel_no_players: 'Aucun joueur pour le moment',
        panel_waiting: 'En attente de joueurs...',
        panel_full: 'Simulateur complet !',
        join_success: 'Vous avez rejoint le simulateur !',
        join_team: 'Vous avez rejoint l’Équipe {team} !',
        switch_team: 'Vous avez changé pour l’Équipe {team} !',
        join_already: 'Vous êtes déjà dans ce simulateur.',
        join_full: 'Ce simulateur est complet.',
        leave_success: 'Vous avez quitté le simulateur.',
        leave_not_in: 'Vous n’êtes pas dans ce simulador.',
        simul_closed: 'Ce simulador n’est plus ouvert.',
        team_same: 'Vous êtes déjà dans cette équipe !',
        team_full: 'Cette équipe est complète !',
        banned_global_title: 'Banni par l’équipe Sky',
        banned_global_desc: 'Vous êtes banni des simulateurs par l’équipe Sky.\n\nFaites appel : https://discord.com/invite/8M83fTdyRW',
        banned_local: 'Vous êtes banni des simulateurs sur ce serveur.',
        error_generic: 'Une erreur est survenue. Réessayez.',
        old_panel_warning: '⚠️ Ce panneau provient d\'une ancienne version et n\'est plus compatible.',
        old_panel_solution: 'Veuillez recréer le simulateur pour utiliser la version mise à jour avec support multilingue.',
        help_title: 'Commandes du bot',
        help_description: 'Voici les principales commandes disponibles sur ce serveur.',
        help_commands: {
            setup: 'Configurer le canal/le rôle/la langue du bot.',
            simulador1v1: 'Créer un simulateur 1v1.',
            simulador2v2: 'Créer un simulateur 2v2.',
            simulador3v3: 'Créer un simulateur 3v3.',
            simulador4v4: 'Créer un simulateur 4v4.',
            banir_simu: 'Bannir un utilisateur sur ce serveur.',
            desbanir_simu: 'Débannir un utilisateur sur ce serveur.',
            banir_jogador: 'Bannir globalement un utilisateur.',
            desbanir_jogador: 'Débannir globalement un utilisateur.',
            banir_server: 'Bannir un serveur.',
            desbanir_server: 'Débannir un serveur.',
            adicionar_permissao: 'Donner la permission de propriétaire à un utilisateur.',
            remover_jogador: 'Retirer ou remplacer un joueur du simulateur.',
            alterar_jogador: 'Remplacer un joueur dans un tournoi en cours.',
            help: 'Afficher cette aide.'
        },
        help_footer: 'Langue: Français',
        setup_success: 'Configuration enregistrée !',
        setup_role: 'Rôle',
        setup_language: 'Langue',
        setup_permission_info: 'Seuls les membres avec le rôle {role} peuvent créer des simulateurs.'
    },
    de: {
        selection_manual: '**Teamauswahl:** Manuell (Team selbst wählen)',
        selection_auto: '**Teamauswahl:** Zufällig',
        panel_title: 'Simulator {mode} – {game}',
        panel_players: '**Spieler ({count}/{max})**',
        panel_team_line: '**Team {num}** ({count}/{max}): {players}',
        panel_no_players: 'Noch keine Spieler',
        panel_waiting: 'Warte auf Spieler...',
        panel_full: 'Simulator voll!',
        join_success: 'Du bist dem Simulator beigetreten!',
        join_team: 'Du bist Team {team} beigetreten!',
        switch_team: 'Du bist zu Team {team} gewechselt!',
        join_already: 'Du bist bereits in diesem Simulator.',
        join_full: 'Dieser Simulator ist voll.',
        leave_success: 'Du hast den Simulator verlassen.',
        leave_not_in: 'Du bist nicht in diesem Simulator.',
        simul_closed: 'Dieser Simulator ist nicht mehr offen.',
        team_same: 'Du bist bereits in diesem Team!',
        team_full: 'Dieses Team ist voll!',
        banned_global_title: 'Von Sky-Team gebannt',
        banned_global_desc: 'Du bist vom Sky-Team für Simulatoren gebannt.\n\nEinspruch: https://discord.com/invite/8M83fTdyRW',
        banned_local: 'Du bist auf diesem Server für Simulatoren gebannt.',
        error_generic: 'Es ist ein Fehler aufgetreten. Bitte erneut versuchen.',
        old_panel_warning: '⚠️ Dieses Panel stammt aus einer alten Version und ist nicht mehr kompatibel.',
        old_panel_solution: 'Bitte erstelle den Simulator neu, um die aktualisierte Version mit mehrsprachiger Unterstützung zu verwenden.',
        help_title: 'Bot-Befehle',
        help_description: 'Hier sind die wichtigsten Befehle auf diesem Server.',
        help_commands: {
            setup: 'Bot-Kanal/Rolle/Sprache konfigurieren.',
            simulador1v1: '1v1-Simulator erstellen.',
            simulador2v2: '2v2-Simulator erstellen.',
            simulador3v3: '3v3-Simulator erstellen.',
            simulador4v4: '4v4-Simulator erstellen.',
            banir_simu: 'Einen Nutzer auf diesem Server bannen.',
            desbanir_simu: 'Ban auf diesem Server aufheben.',
            banir_jogador: 'Nutzer global bannen.',
            desbanir_jogador: 'Globalen Ban aufheben.',
            banir_server: 'Einen Server bannen.',
            desbanir_server: 'Server-Ban aufheben.',
            adicionar_permissao: 'Owner-Rechte an einen Nutzer geben.',
            remover_jogador: 'Spieler aus Simulator entfernen/ersetzen.',
            alterar_jogador: 'Spieler im laufenden Turnier ersetzen.',
            help: 'Diese Hilfe anzeigen.'
        },
        help_footer: 'Sprache: Deutsch',
        setup_success: 'Konfiguration gespeichert!',
        setup_role: 'Rolle',
        setup_language: 'Sprache',
        setup_permission_info: 'Nur Mitglieder mit der Rolle {role} können Simulatoren erstellen.'
    }
};

function format(template, params = {}) {
    return template.replace(/\{(\w+)\}/g, (_, k) => params[k] ?? '');
}

function t(lang = 'en', key, params) {
    const dict = dictionaries[lang] || dictionaries.en;
    const value = dict[key] ?? dictionaries.en[key] ?? key;
    if (typeof value === 'string') return format(value, params);
    return value; // for objects (help_commands)
}

function getHelpCommands(lang = 'en') {
    const dict = dictionaries[lang] || dictionaries.en;
    return dict.help_commands || dictionaries.en.help_commands;
}

module.exports = { t, getHelpCommands };
